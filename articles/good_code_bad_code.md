---
title: "ã€Œè‰¯ã„ã‚³ãƒ¼ãƒ‰/æ‚ªã„ã‚³ãƒ¼ãƒ‰ã§å­¦ã¶è¨­è¨ˆå…¥é–€ã€ã®ç†è§£ã‚’PHP(Laravel)ã§æ·±ã‚ã‚ˆã‹"
emoji: "ðŸ‘»"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Laravel", "è¨­è¨ˆ", "å“è³ª", "ãƒŸãƒŽé§†å‹•æœ¬"]
published: false
---

# TL;DR

- ã€Œè‰¯ã„ã‚³ãƒ¼ãƒ‰/æ‚ªã„ã‚³ãƒ¼ãƒ‰ã§å­¦ã¶è¨­è¨ˆå…¥é–€ã€ã‚’ãƒ†ãƒ¼ãƒžã«ã€PHP(Laravel)ã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨­è¨ˆåŽŸå‰‡ã‚’è©³è§£
- å„ãƒˆãƒ”ãƒƒã‚¯ã”ã¨ã«ã€Œå•é¡Œã®ã‚³ãƒ¼ãƒ‰ã€ä¾‹ã¨ã€Œæ”¹è‰¯ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã€ä¾‹ã‚’ PHP(Laravel)ã§æä¾›ã—ã€è‰¯ã„è¨­è¨ˆåŽŸå‰‡ã«å¾“ã†æ–¹æ³•ã‚’å…·ä½“çš„ã«æç¤º
- ã“ã‚Œã‚’èª­ã‚ã°ã€è¨­è¨ˆåŽŸå‰‡ã®ç†è§£ãŒæ·±ã¾ã‚Šè‡ªèº«ã®é–‹ç™ºã«æ´»ã‹ã›ã‚‹ã¯ãš
- ã‚‚ã¡ã‚ã‚“å…¨ãƒˆãƒ”ãƒƒã‚¯ã‚’æ‰±ã†ã‚ã‘ã§ã¯ãªã„ã®ã§ã€æ°—ã«ãªã£ãŸäººã¯ãœã²è³¼å…¥ã‚’

https://gihyo.jp/book/2022/978-4-297-12783-1

# ç¬¬ 1 ç«  æ‚ªã—ãæ§‹é€ ã®å¼Šå®³ã‚’çŸ¥è¦šã™ã‚‹

## 1. æ„å‘³ä¸æ˜Žãªå‘½å

### å•é¡Œã®ã‚³ãƒ¼ãƒ‰

ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ã‚¯ãƒ©ã‚¹ã®å‘½åã«ãŠã„ã¦ã¯ã€æŠ€è¡“çš„ãªè©³ç´°ã‚„ä½¿ç”¨ã—ã¦ã„ã‚‹æŠ€è¡“ãã®ã‚‚ã®ã‚’è¡¨ã™åå‰ï¼ˆã€ŒæŠ€è¡“é§†å‹•å‘½å(Technology-driven naming)ã€ã¨ã„ã†ï¼‰ã‚ˆã‚Šã‚‚ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’åæ˜ ã—ãŸåå‰ã‚’ä½¿ç”¨ã™ã¹ãã¨ã„ã†è€ƒãˆæ–¹ãŒã‚ã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã«ã€æŠ€è¡“é§†å‹•å‘½åã®ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

```php
class UserController extends Controller {
    public function getUserFromDB($id) {
        $user = User::find($id);
        return view('user.show', ['user' => $user]);
    }
}
```

### æ”¹è‰¯ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰

ã“ã® `getUserFromDB` ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ãã®åå‰ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—ã™ã‚‹ã¨ã„ã†å®Ÿè£…è©³ç´°ã‚’å«ã‚“ã§ã„ã¾ã™ã€‚ã—ã‹ã—ã€ãƒ¡ã‚½ãƒƒãƒ‰ã®ä¸»ãªç›®çš„ã¯ã€ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è©³ç´°ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€ã“ã®ã‚ˆã†ãªå ´åˆã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«åå‰ã‚’å¤‰æ›´ã™ã¹ãã§ã™ã€‚

```php
class UserController extends Controller {
    public function show($id) {
        $user = User::find($id);
        return view('user.show', ['user' => $user]);
    }
}
```

ã“ã®æ”¹è‰¯ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã§ã¯ã€ `show` ã¨ã„ã†åå‰ãŒãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚ˆã‚Šç›´æŽ¥çš„ã«åæ˜ ã—ã¦ã„ã¾ã™ã€‚

## 2. ç†è§£ã‚’å›°é›£ã«ã™ã‚‹æ¡ä»¶åˆ†å²ã®ãƒã‚¹ãƒˆ

### å•é¡Œã®ã‚³ãƒ¼ãƒ‰

æ¡ä»¶åˆ†å²ãŒæ·±ããƒã‚¹ãƒˆã•ã‚Œã¦ã—ã¾ã†ã¨ã€ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ã¯å¤§ããä½Žä¸‹ã—ã€çµæžœçš„ã«ç†è§£ãŒå›°é›£ã«ãªã‚‹å‚¾å‘ãŒã‚ã‚Šã¾ã™ã€‚ã•ã‚‰ã«ã€æ¡ä»¶ã®è¤‡é›‘ã•ãŒå¢—ã™ã¨ã€ãã‚Œã«ä¼´ã£ã¦ãƒã‚°ã®ç™ºç”ŸçŽ‡ã‚‚é«˜ã¾ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã«ã€ã“ã®ãƒã‚¹ãƒˆã—ãŸæ¡ä»¶åˆ†å²ã®å•é¡Œã‚’å…·ä½“çš„ã«ç¤ºã™ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

```php
class UserController extends Controller {
    public function show($id) {
        $user = User::find($id);

        if ($user) {
            if ($user->isActive()) {
                return view('user.show', ['user' => $user]);
            } else {
                return redirect('home')->with('error', 'User is not active');
            }
        } else {
            return redirect('home')->with('error', 'User not found');
        }
    }
}
```

### æ”¹è‰¯ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰

å•é¡Œã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹ã¨ã€äºŒã¤ã®æ¡ä»¶ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹ã€ãã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‹ã©ã†ã‹ã¨ã„ã†æ¡ä»¶ãŒãƒã‚¹ãƒˆã—ã¦ã„ã¾ã™ã€‚

ã“ã®ã‚ˆã†ãªãƒã‚¹ãƒˆã—ãŸæ¡ä»¶åˆ†å²ã¯ã€ã€Œã‚¬ãƒ¼ãƒ‰ç¯€ã€ã‚’ä½¿ç”¨ã—ã¦å¹³å¦åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚¬ãƒ¼ãƒ‰ç¯€ã¨ã¯ã€é–¢æ•°ã®å…ˆé ­ã§ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦æ—©æœŸã«ãƒªã‚¿ãƒ¼ãƒ³ã™ã‚‹ã¨ã„ã†ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã§ã™ã€‚

ä»¥ä¸‹ã«ã€ã‚¬ãƒ¼ãƒ‰ç¯€ã‚’ä½¿ç”¨ã—ã¦æ”¹å–„ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ç¤ºã—ã¾ã™ã€‚

```php
class UserController extends Controller {
    public function show($id) {
        $user = User::find($id);

        if (!$user) {
            return redirect('home')->with('error', 'User not found');
        }

        if (!$user->isActive()) {
            return redirect('home')->with('error', 'User is not active');
        }

        return view('user.show', ['user' => $user]);
    }
}
```

## 3. ã•ã¾ã–ã¾ãªæ‚ªé­”ã‚’æ‹›ãã‚„ã™ã„ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹

### å•é¡Œã®ã‚³ãƒ¼ãƒ‰

ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã¨ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®æ ¼ç´ã¨å–å¾—ã®ã¿ã‚’è¡Œã†ã‚¯ãƒ©ã‚¹ã‚’æŒ‡ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¯ãƒ©ã‚¹ãŒãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŒãŸãªã„ãŸã‚ã«èµ·ã“ã‚‹å•é¡Œã¯ã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒã‚¯ãƒ©ã‚¹å¤–éƒ¨ã«æ•£åœ¨ã—ã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚‹ã¨ã„ã†ç‚¹ã§ã™ã€‚

ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```php
class User {
    public $name;
    public $email;
}

class UserService {
    public function changeEmail(User $user, $newEmail) {
        // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼æ¤œè¨¼
        if (!filter_var($newEmail, FILTER_VALIDATE_EMAIL)) {
            throw new Exception('Invalid email format');
        }

        $user->email = $newEmail;
    }
}
```

### æ”¹è‰¯ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰

ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`User` ã‚¯ãƒ©ã‚¹ã¯å˜ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ã ã‘ã®ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹ã§ã€ãã‚Œã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯`UserService` ã‚¯ãƒ©ã‚¹ã«å­˜åœ¨ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€`User`ã‚¯ãƒ©ã‚¹ãŒãã®ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’è‡ªèº«ã§ä¿è¨¼ã™ã‚‹ã“ã¨ãŒã§ããªããªã‚Šã€å…¨ã¦ã®æ“ä½œãŒ `UserService` ã‚’é€šã˜ã¦è¡Œã‚ã‚Œã‚‹ã“ã¨ãŒå¿…ãšã—ã‚‚ä¿è¨¼ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã®ä¸æ•´åˆãŒç™ºç”Ÿã™ã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã¯ã€é–‹ç™ºè€…ãŒãƒ‡ãƒ¼ã‚¿ã¨ãã®ãƒ‡ãƒ¼ã‚¿ã‚’æ“ä½œã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¸€ç·’ã«æŒã¤ã‚ˆã†ã«ã‚¯ãƒ©ã‚¹ã‚’è¨­è¨ˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```php
class User {
    public $name;
    public $email;

    public function __construct($name, $email) {
        if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
            throw new Exception('Invalid email format');
        }
        $this->name = $name;
        $this->email = $email;
    }

    public function changeEmail($newEmail) {
        if (!filter_var($newEmail, FILTER_VALIDATE_EMAIL)) {
            throw new Exception('Invalid email format');
        }
        $this->email = $newEmail;
    }
}
```
